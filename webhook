-- ‚úÖ Script g·ª≠i Webhook AFK Reward - D√πng setting to√†n c·ª•c
-- setting = { ['Webhook Url'] = "..." } ph·∫£i ƒë∆∞·ª£c khai b√°o tr∆∞·ªõc

local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local Player = Players.LocalPlayer

-- L·∫•y Webhook t·ª´ bi·∫øn setting to√†n c·ª•c
local WebhookURL = setting and setting["Webhook Url"]
if not WebhookURL then
    warn("[‚ùå] Thi·∫øu Webhook Url trong setting!")
    return
end

-- ƒê·ª£i giao di·ªán CountDown xu·∫•t hi·ªán
local rewardGui
repeat
    rewardGui = Player:FindFirstChild("PlayerGui") and Player.PlayerGui:FindFirstChild("CountDown")
    task.wait(1)
until rewardGui and rewardGui:FindFirstChild("Frame")

local receivedFrame = rewardGui.Frame:FindFirstChild("Recieved")
if not receivedFrame then
    warn("[‚ùå] Kh√¥ng t√¨m th·∫•y khung nh·∫≠n th∆∞·ªüng!")
    return
end

print("[‚úÖ] ƒê√£ t√¨m th·∫•y giao di·ªán nh·∫≠n th∆∞·ªüng AFK!")

local lastItemSent = ""

-- G·ª≠i Webhook khi c√≥ item m·ªõi
local function onChildAdded(child)
    task.wait(0.2)
    local rewardNameLabel = child:FindFirstChild("RewardName")
    if rewardNameLabel and rewardNameLabel:IsA("TextLabel") then
        local itemName = rewardNameLabel.Text
        if itemName and itemName ~= lastItemSent then
            lastItemSent = itemName

            local data = {
                username = "AFK Rewards Bot",
                embeds = {{
                    title = "üéÅ Nh·∫≠n ƒë∆∞·ª£c v·∫≠t ph·∫©m m·ªõi!",
                    fields = {
                        {
                            name = "üéÅ Item",
                            value = "**" .. itemName .. "**",
                            inline = true
                        },
                        {
                            name = "üôã Ng∆∞·ªùi ch∆°i",
                            value = "**" .. Player.Name .. "**",
                            inline = true
                        }
                    },
                    color = 65280
                }}
            }

            local success, err = pcall(function()
                syn.request({
                    Url = WebhookURL,
                    Method = "POST",
                    Headers = {
                        ["Content-Type"] = "application/json"
                    },
                    Body = HttpService:JSONEncode(data)
                })
            end)

            if success then
                print("[‚úÖ] ƒê√£ g·ª≠i item v·ªÅ Webhook:", itemName)
            else
                warn("[‚ùå] Webhook l·ªói:", err)
            end
        end
    end
end

-- Theo d√µi ph·∫ßn t·ª≠ trong ScrollingFrame
local scrollingFrame = receivedFrame:FindFirstChild("ScrollingFrame")
if scrollingFrame then
    scrollingFrame.ChildAdded:Connect(onChildAdded)
    print("[üëÄ] ƒêang theo d√µi item trong khu AFK...")
else
    warn("[‚ùå] Kh√¥ng t√¨m th·∫•y ScrollingFrame trong Received!")
end

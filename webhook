-- ‚úÖ AFK Item Webhook Tracker - h·ªó tr·ª£ nhi·ªÅu executor
return function(setting)
    local HttpService = game:GetService("HttpService")
    local Players = game:GetService("Players")
    local Player = Players.LocalPlayer

    local WebhookURL = setting and setting["Webhook Url"]
    if not WebhookURL then
        warn("[‚ùå] Thi·∫øu Webhook Url trong setting!")
        return
    end

    -- Ch·ªù GUI nh·∫≠n th∆∞·ªüng xu·∫•t hi·ªán
    local rewardGui
    repeat
        rewardGui = Player:FindFirstChild("PlayerGui") and Player.PlayerGui:FindFirstChild("CountDown")
        task.wait(1)
    until rewardGui and rewardGui:FindFirstChild("Frame")

    local receivedFrame = rewardGui.Frame:FindFirstChild("Recieved")
    if not receivedFrame then
        warn("[‚ùå] Kh√¥ng t√¨m th·∫•y khung nh·∫≠n th∆∞·ªüng!")
        return
    end

    print("[‚úÖ] ƒê√£ t√¨m th·∫•y giao di·ªán nh·∫≠n th∆∞·ªüng AFK!")

    local lastItemSent = ""

    -- H√†m g·ª≠i Webhook
    local function sendWebhook(itemName)
        local data = {
            username = Player.Name .. " - AFK Bot",
            embeds = {{
                title = "üéÅ Nh·∫≠n ƒë∆∞·ª£c v·∫≠t ph·∫©m m·ªõi!",
                description = "**" .. itemName .. "**",
                color = 65280
            }}
        }

        local jsonData = HttpService:JSONEncode(data)
        local requestFunc =
            (syn and syn.request) or
            (http and http.request) or
            (request) or
            (fluxus and fluxus.request) or
            (krnl and krnl.request)

        if requestFunc then
            local success, err = pcall(function()
                requestFunc({
                    Url = WebhookURL,
                    Method = "POST",
                    Headers = {
                        ["Content-Type"] = "application/json"
                    },
                    Body = jsonData
                })
            end)

            if success then
                print("[‚úÖ] ƒê√£ g·ª≠i item v·ªÅ Webhook:", itemName)
            else
                warn("[‚ùå] Webhook l·ªói:", err)
            end
        else
            warn("[‚ùå] Kh√¥ng t√¨m th·∫•y h√†m g·ª≠i Webhook ph√π h·ª£p!")
        end
    end

    -- Theo d√µi item m·ªõi ƒë∆∞·ª£c th√™m v√†o
    local scrollingFrame = receivedFrame:FindFirstChild("ScrollingFrame")
    if scrollingFrame then
        scrollingFrame.ChildAdded:Connect(function(child)
            task.wait(0.2)
            local rewardNameLabel = child:FindFirstChild("RewardName")
            if rewardNameLabel and rewardNameLabel:IsA("TextLabel") then
                local itemName = rewardNameLabel.Text
                if itemName and itemName ~= lastItemSent then
                    lastItemSent = itemName
                    sendWebhook(itemName)
                end
            end
        end)
        print("[üëÄ] ƒêang theo d√µi item trong khu AFK...")
    else
        warn("[‚ùå] Kh√¥ng t√¨m th·∫•y ScrollingFrame trong Received!")
    end
end
